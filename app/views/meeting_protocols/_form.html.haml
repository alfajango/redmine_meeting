- content_for(:header_tags) do
  = javascript_include_tag :jquery_nested_form, :plugin => 'redmine_meeting'

= f.hidden_field :meeting_agenda_id
= error_messages_for @object
= back_url_hidden_field_tag
- heads_for_wiki_formatter
- include_calendar_headers_tags

.box.tabular

  .splitcontentleft
    %p
      = f.label :start_time, l(:label_meeting_protocol_start_time)
      = f.time_select :start_time, minute_step: 10, blank: true
  .splitcontentright
    %p
      = f.label :end_time, l(:label_meeting_protocol_end_time)
      = f.time_select :end_time, minute_step: 10, blank: true

  -#%div{style: "clear:both"}

  %h3=l :label_meeting_answer_plural
  = f.fields_for :meeting_answers
  = f.link_to_add l(:button_add), :meeting_answers, class: 'icon icon-add'

  %fieldset
    %legend
      = l(:label_attachment_plural)
    = link_to_attachments @object if @object.attachments.any?
    %p= render partial: 'attachments/form', locals: {container: @object}

  :javascript
    $(function() {
      $('.wiki-edit').each( function(index){
        var wikiToolbar = new jsToolBar(this);
        wikiToolbar.setHelpLink('#{escape_javascript Redmine::Utils.relative_url_root+"/help/wiki_syntax.html"}');
        wikiToolbar.draw();
      } );
      $('.autocomplete_for_issue:not(.autocomplete)').each( function(index){
        observeAutocompleteField( $(this).attr('id'), '#{escape_javascript autocomplete_for_issue_meeting_agendas_path}')
      } );
      $('.datepickme').each( function(index){
        $(this).datepicker(datepickerOptions);
      } );

      $(document).on('nested:fieldAdded', function() {
        $('.wiki-edit:not(.jstEditor > .wiki-edit)').each( function(index){
          var wikiToolbar = new jsToolBar(this);
          wikiToolbar.setHelpLink('#{escape_javascript Redmine::Utils.relative_url_root+"/help/wiki_syntax.html"}');
          wikiToolbar.draw();
        } );
        $('.autocomplete_for_issue:not(.autocomplete)').each( function(index){
          observeAutocompleteField( $(this).attr('id'), '#{escape_javascript autocomplete_for_issue_meeting_agendas_path}')
        } );
        $('.datepickme').each( function(index){
          $(this).datepicker(datepickerOptions);
        } );
      });
    });
