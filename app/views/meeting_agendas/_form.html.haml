- content_for(:header_tags) do
  = javascript_include_tag :jquery_nested_form, :plugin => 'redmine_meeting'

= error_messages_for @object
= back_url_hidden_field_tag

.box.tabular
  %fieldset
    %p
      = f.label :subject
      = f.text_field :subject, size: 100, style: "width: 80%"
    %p
      = f.label :place
      = f.text_field :place, size: 100, style: "width: 60%"
      :javascript
        observeAutocompleteField('meeting_agenda_place', '#{escape_javascript autocomplete_for_place_meeting_agendas_path}')
      = link_to l(:label_meeting_room_reserve_new), {controller: 'meeting_room_selectors', action: 'new'}, remote: true, method: 'get', class: 'icon icon-add'
    .splitcontentleft
      %p
        = f.label :meet_on
        = f.text_field :meet_on, size: 10, class: "calendar_for"
        = calendar_for('meeting_agenda_meet_on')
      %p
        = f.label :priority_id, l(:field_priority)
        = f.collection_select :priority_id, IssuePriority.all, :id, :name, :prompt => t(:prompt_please_select)
    .splitcontentright
      %p
        = f.label :start_time, l(:label_meeting_agenda_start_time)
        = f.time_select :start_time, minute_step: 5, include_blank: true
      %p
        = f.label :end_time, l(:label_meeting_agenda_end_time)
        = f.time_select :end_time, minute_step: 5, include_blank: true
  %h3{style: "margin-top: 33px"}=l :label_meeting_question_plural
  = f.fields_for :meeting_questions
  = f.link_to_add l(:button_add), :meeting_questions, class: 'icon icon-add'

  %fieldset
    %legend= l(:label_attachment_plural)
    = link_to_attachments @object if @object.attachments.any?
    %p= render partial: 'attachments/form', locals: {container: @object}


  :javascript
    $(function() {
      $('.autocomplete_for_issue:not(.autocomplete)').each( function(index){
        observeAutocompleteField( $(this).attr('id'), '#{escape_javascript autocomplete_for_issue_meeting_agendas_path}')
      } );
      $(document).on('nested:fieldAdded', function() {
        $('.autocomplete_for_issue:not(.autocomplete)').each( function(index){
          observeAutocompleteField( $(this).attr('id'), '#{escape_javascript autocomplete_for_issue_meeting_agendas_path}')
        } );
      });
    });
